<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>DookuG module JAVA documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>DookuG module JAVA documentation</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_overview">1. Overview</a>
<ul class="sectlevel2">
<li><a href="#_components">1.1. Components</a></li>
</ul>
</li>
<li><a href="#_backend">2. Backend</a>
<ul class="sectlevel2">
<li><a href="#_services">2.1. Services</a>
<ul class="sectlevel3">
<li><a href="#_dookug_document_service">2.1.1. DOOKUG-DOCUMENT Service</a>
<ul class="sectlevel4">
<li><a href="#_document_generation">2.1.1.1. Document Generation</a></li>
<li><a href="#generateInline">2.1.1.2. Document generation based on request body</a></li>
<li><a href="#generateInlineMetadata">2.1.1.3. Document generation based on request body, with metadata response</a></li>
<li><a href="#generateInlineMultipart">2.1.1.4. Document generation based on multipart form</a></li>
<li><a href="#generateInlineMultipartMetadata">2.1.1.5. Document generation based on multipart form, with metadata response</a></li>
<li><a href="#generateStored">2.1.1.6. Document generation based on stored template</a></li>
<li><a href="#generateStoredMetadata">2.1.1.7. Document generation based on stored template, with metadata response</a></li>
<li><a href="#queryDocumentMetadata">2.1.1.8. Query Document Metadata</a></li>
<li><a href="#getDocument">2.1.1.9. Get Document</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_openapi_documentation">2.2. OpenAPI Documentation</a></li>
</ul>
</li>
<li><a href="#_dookug_module_client">3. DookuG Module Client</a>
<ul class="sectlevel2">
<li><a href="#_technology">3.1. Technology</a></li>
<li><a href="#_usage">3.2. Usage</a></li>
<li><a href="#methods">3.3. Operation</a>
<ul class="sectlevel4">
<li><a href="#_using_saxon_he_engine_in_the_client">3.3.1. Using Saxon-HE Engine in the Client</a></li>
</ul>
</li>
<li><a href="#_error_handling">3.4. Error Handling</a></li>
</ul>
</li>
<li><a href="#_configuration">4. Configuration</a>
<ul class="sectlevel2">
<li><a href="#_backend_2">4.1. Backend</a>
<ul class="sectlevel3">
<li><a href="#_dookug_document_service_2">4.1.1. DOOKUG-DOCUMENT service</a>
<ul class="sectlevel5">
<li><a href="#_dookug_keys">dookug keys</a></li>
</ul>
</li>
<li><a href="#pdfSignatureConfiguration">4.1.2. Pdf Signature configuration</a></li>
</ul>
</li>
<li><a href="#_client">4.2. Client</a></li>
</ul>
</li>
<li><a href="#_installation_deployment">5. Installation, Deployment</a>
<ul class="sectlevel2">
<li><a href="#_dookug_document_service_3">5.1. DOOKUG-DOCUMENT Service</a>
<ul class="sectlevel3">
<li><a href="#_service_configuration">5.1.1. Service configuration</a></li>
<li><a href="#_recommended_k8s_configuration">5.1.2. Recommended K8S Configuration</a></li>
<li><a href="#_observability">5.1.3. Observability</a>
<ul class="sectlevel4">
<li><a href="#_health_startuplivenessreadiness">5.1.3.1. Health - startup/liveness/readiness</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_additional_informations">6. Additional informations</a>
<ul class="sectlevel2">
<li><a href="#_template_cache">6.1. Template Cache</a></li>
<li><a href="#_helpers_helper_functions_for_use_in_template_files">6.2. Helpers - Helper Functions for Use in Template Files</a>
<ul class="sectlevel3">
<li><a href="#_built_in_helpers">6.2.1. Built-in Helpers</a></li>
<li><a href="#_custom_helpers">6.2.2. Custom Helpers</a>
<ul class="sectlevel4">
<li><a href="#_usage_2">6.2.2.1. Usage</a></li>
<li><a href="#_additional_helper_functions">6.2.2.2. Additional Helper Functions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_using_custom_fonts">6.3. Using Custom Fonts</a></li>
<li><a href="#_digitally_signing_pdfs">6.4. Digitally Signing PDFs</a>
<ul class="sectlevel3">
<li><a href="#_configuration_2">6.4.1. Configuration</a></li>
<li><a href="#_visible_signature_using_the_eu_dss_esign_library">6.4.2. Visible signature (using the EU DSS ESIGN library)</a></li>
</ul>
</li>
<li><a href="#_keystore_cache_for_digital_signature">6.5. Keystore Cache for digital signature</a></li>
</ul>
</li>
<li><a href="#_release_notes">7. Release notes</a>
<ul class="sectlevel2">
<li><a href="#_v0_4_0">7.1. v0.4.0</a></li>
<li><a href="#_v0_5_0">7.2. v0.5.0</a>
<ul class="sectlevel3">
<li><a href="#_changes_updates">7.2.1. Changes / updates</a></li>
<li><a href="#_migration">7.2.2. Migration</a></li>
</ul>
</li>
<li><a href="#_v0_6_0">7.3. v0.6.0</a>
<ul class="sectlevel3">
<li><a href="#_changes_updates_2">7.3.1. Changes / updates</a></li>
<li><a href="#_migration_2">7.3.2. Migration</a></li>
</ul>
</li>
<li><a href="#_v1_0_0">7.4. v1.0.0</a>
<ul class="sectlevel3">
<li><a href="#_changes_updates_3">7.4.1. Changes / updates</a></li>
<li><a href="#_migration_3">7.4.2. Migration</a></li>
</ul>
</li>
<li><a href="#_v1_1_0">7.5. v1.1.0</a>
<ul class="sectlevel3">
<li><a href="#_changes_updates_4">7.5.1. Changes / updates</a></li>
<li><a href="#_migration_4">7.5.2. Migration</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Version: 1.1.0-SNAPSHOT</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">1. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The project aims to enable general template-based document generation for its clients.</p>
</div>
<div class="sect2">
<h3 id="_components">1.1. Components</h3>
<div class="imageblock">
<div class="content">
<a class="image" href="assets/images/dkg_architecture.png" target="_blank" rel="noopener"><img src="assets/images/dkg_architecture.png" alt="Architecture"></a>
</div>
<div class="title">Figure 1. Architecture Diagram</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. DookuG Backend 1.1.0-SNAPSHOT</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Module</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock"><strong>Internal</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oracle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">21.3.0-xe</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PostgreSQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dwh postgres image 0.10.0</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_backend">2. Backend</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_services">2.1. Services</h3>
<div class="sect3">
<h4 id="_dookug_document_service">2.1.1. DOOKUG-DOCUMENT Service</h4>
<div class="sect4">
<h5 id="_document_generation">2.1.1.1. Document Generation</h5>
<div class="paragraph">
<p>The module provides multiple options for document generation. For each option, we need to specify the template and how the document should be processed by the engine, in what format we want to receive the file, and how we want to store the generated document. If the format of the generated document is not a STRING value but an engine that can process the document is not provided, or if STRING format is desired but PDF_BOX engine is specified, an INVALID_INPUT error will be returned. When generating documents based on the initial template, parameters must also be specified. There are several options for specifying it, one of which is to send it in key-value pairs. The other option is to expect a json structure that is to be sent in base64binary form in the request.</p>
</div>
</div>
<div class="sect4">
<h5 id="generateInline">2.1.1.2. Document generation based on request body</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">POST /internal/dookug/document/generate/inline</code></pre>
</div>
</div>
<div class="paragraph">
<p>During generation, we submit the initial template and the data associated with the generation in the request body: template and engine processing the document, response format, and document storage method.</p>
</div>
<div class="paragraph">
<p>Sample document generation request - JSON parameters in base64binary form (trimmed for readability):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-http request" data-lang="http request">Request method:	POST
Request URI:	http://localhost:8082/internal/dookug/document/generate/inline
Headers:		Accept=application/json
				Content-Type=application/json</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "context": {
    "requestId": "431AZYLPPS6LJE01",
    "timestamp": "2023-02-22T09:12:23.533Z"
  },
  "generatorSetup": {
    "generatorEngine": "PDF_BOX",
    "templateEngine": "HANDLEBARS",
    "parametersData": "ewogICAgIklOU1RJVFVURV9OQU1FIjogIlNpw7Nmb2tpIGvDs3Jow...",
    "responseFormat": "PDF",
    "documentStorageMethod": "DATABASE"
  },
  "templates": [
    {
      "templateName": "main_template",
      "templateContent": "PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KCjxzdHls...",
      "initial": true
    },
    {
      "templateName": "head_template",
      "templateContent": "PHRhYmxlIHN0eWxlPSJoZWlnaHQ6IDE2MXB4OyB3aWR0aDog...",
      "initial": false
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the response, we receive the generated document and the filename in the HTTP header.</p>
</div>
</div>
<div class="sect4">
<h5 id="generateInlineMetadata">2.1.1.3. Document generation based on request body, with metadata response</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">POST /internal/dookug/document/generate/inline/metadata</code></pre>
</div>
</div>
<div class="paragraph">
<p>There&#8217;s an option to receive metadata describing the document instead of the document itself. In this case, the request URI and HTTP header differ when submitting the request.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-http request" data-lang="http request">Request method:	POST
Request URI:	http://localhost:8082/internal/dookug/document/generate/inline/metadata
Headers:		Accept=application/json
				Content-Type=application/json</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="generateInlineMultipart">2.1.1.4. Document generation based on multipart form</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">POST /internal/dookug/document/generate/inline/multipart</code></pre>
</div>
</div>
<div class="paragraph">
<p>To generate, we need to submit the initial template and the data associated with the generation. The latter matches the data sent for document generation based on the request body.</p>
</div>
<div class="paragraph">
<p>Sample document generation multipart form request with key-value parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-http request" data-lang="http request">Request method:	POST
Request URI:	http://localhost:8082/internal/dookug/document/generate/inline/multipart
Headers:		Accept=application/octet-stream
				Content-Type=multipart/form-data

Content-Disposition: form-data; name="REQUEST"
Content-Type: application/json
{
    "context": {
      "requestId": "42ZZBR3LKJZ9IT0X",
      "timestamp": "2023-02-21T12:57:52.113Z"
    },
    "generatorSetup": {
      "generatorEngine": "PDF_BOX",
      "templateEngine": "HANDLEBARS",
      "parameters":[{"key":"first","value":"első"},{"key":"second","value":"í123456789öüóőúűáé-.,&lt;&gt;#&amp;@{};*¤ß$"}],
      "responseFormat": "PDF",
      "documentStorageMethod": "DATABASE"
    }
}
--2b17c723-ec5b-4c99-8dcf-c6d8972c4564
Content-Disposition: form-data; name="TEMPLATE"
Content-Type: application/octet-stream

DookuG simple test with prameters first: [{{first}}], second: [{{second}}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the response, we receive the generated document and the filename in the HTTP header.</p>
</div>
</div>
<div class="sect4">
<h5 id="generateInlineMultipartMetadata">2.1.1.5. Document generation based on multipart form, with metadata response</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">POST /internal/dookug/document/generate/inline/multipart/metadata</code></pre>
</div>
</div>
<div class="paragraph">
<p>There&#8217;s also an option to receive metadata describing the document instead of the document itself. In this case, the request URI and HTTP header differ when submitting the request.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-http request" data-lang="http request">Request method:	POST
Request URI:	http://localhost:8082/internal/dookug/document/generate/inline/multipart/metadata
Headers:		Accept=application/json
				Content-Type=multipart/form-data</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="generateStored">2.1.1.6. Document generation based on stored template</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">POST /internal/dookug/document/generate/storedTemplate</code></pre>
</div>
</div>
<div class="paragraph">
<p>To generate, we need to submit the name of the template from which the document is generated, along with the data associated with the generation. The latter matches the data sent for document generation based on the request body, supplemented with how the template is stored.</p>
</div>
<div class="paragraph">
<p>Sample document generation based on stored template request - JSON parameters in base64binary form (trimmed for readability):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-http request" data-lang="http request">Request method:	POST
Request URI:	http://localhost:8082/internal/dookug/document/generate/storedTemplate
Headers:		Accept=application/json
				Content-Type=application/json</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "context": {
    "requestId": "431BIFEOUJ0ODU01",
    "timestamp": "2023-02-22T09:26:45.121Z"
  },
  "generatorSetup": {
    "templateStorageMethod": "DATABASE",
    "template": {
      "templateName": "DEV_TEMPLATE_HANDLEBARS",
      "templateLanguage": "HU",
      "validityDate": "2023-02-22T09:26:45.130074Z"
    },
    "generatorEngine": "PDF_BOX",
    "templateEngine": "HANDLEBARS",
    "parametersData": "ewogICJ0aXRsZSI6ICJwZWxkYSBjaW0iLAogICJjdXJyZW50WWV...",
    "responseFormat": "PDF",
    "documentStorageMethod": "DATABASE"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the response, we receive the generated document and the filename in the HTTP header.</p>
</div>
</div>
<div class="sect4">
<h5 id="generateStoredMetadata">2.1.1.7. Document generation based on stored template, with metadata response</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">POST /internal/dookug/document/generate/storedTemplate/metadata</code></pre>
</div>
</div>
<div class="paragraph">
<p>There&#8217;s an option to receive metadata describing the document instead of the document itself. In this case, the request URI and HTTP header differ when submitting the request.</p>
</div>
<div class="paragraph">
<p>The template key stored in the database consists of the templateName and templateLanguage values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-http request" data-lang="http request">Request method:	POST
Request URI:	http://localhost:8082/internal/dookug/document/generate/storedTemplate/metadata
Headers:		Accept=application/json
				Content-Type=application/json</code></pre>
</div>
</div>
<hr>
<div class="paragraph">
<p>Saving the document depends on the <code>documentStorageMethod</code> parameter. It can take two values: <code>NONE</code> and <code>DATABASE</code>. If <code>NONE</code> is specified, the document is not saved, and therefore cannot be queried later. In case of <code>DATABASE</code>, the generated document is saved in a database table, from where it can be retrieved later. Other data related to the document are also saved in the database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>identifier of the initial template - if the template is not saved, this parameter is not filled</p>
</li>
<li>
<p>filename of the generated file - generated from the unique identifier of the document, the name of the initial template, and the timestamp of the generation long value</p>
</li>
<li>
<p>file format</p>
</li>
<li>
<p>document status - DONE, FAILED, PENDING, SYNCING</p>
</li>
<li>
<p>parameters related to the document</p>
</li>
<li>
<p>document storage format - in case of the field DATABASE, this field is also filled with DATABASE value</p>
</li>
</ul>
</div>
<hr>
<div class="paragraph">
<p>During generation, the initial template is provided in any form of the response, the generated file is received, or metadata describing the document is received, as a DocumentMetadataResponse type object.</p>
</div>
<div class="paragraph">
<p>Sample DocumentMetadataResponse:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "context": {
      "requestId": "42ZZBQ5K7W43FI6W",
      "timestamp": "2023-02-21T12:57:50.888Z"
    },
    "funcCode": "OK",
    "metadata": {
      "documentId": "42ZZBQ3ISCXWVO6V",
      "storageMethod": "DATABASE",
      "filename": "filename.pdf",
      "format": "PDF",
      "status" : "DONE"
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="queryDocumentMetadata">2.1.1.8. Query Document Metadata</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">POST /internal/dookug/document/storedTemplate/metadata/query</code></pre>
</div>
</div>
<div class="paragraph">
<p>The purpose of querying document metadata is to retrieve document information that meets the specified filtering criteria.</p>
</div>
<div class="paragraph">
<p>The endpoint supports pagination, meaning data can be retrieved across multiple pages.
In the request, you can specify which page of data and how many elements per page you want to retrieve.
Accordingly, the response includes total count of elements and the number of pages they span.
If not specified, the endpoint defaults to returning the first 15 elements.</p>
</div>
<div class="paragraph">
<p>The following filtering criteria can be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>templateId - identifier of the template used for document generation</p>
</li>
<li>
<p>status - status of the document</p>
</li>
<li>
<p>format - file format of the document</p>
</li>
<li>
<p>storageMethod - storage method of the document</p>
</li>
<li>
<p>storageId - unique identifier of the document storage</p>
</li>
<li>
<p>filename - name of the document file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sorting parameters can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>filename</p>
</li>
<li>
<p>documentStorageMethod</p>
</li>
<li>
<p>format</p>
</li>
<li>
<p>status</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For sorting, you can specify whether to sort in ascending or descending order for each parameter individually.
In addition to the mentioned sorting options, there is a default sorting by document identifier.</p>
</div>
<div class="paragraph">
<p>Sample DocumentMetadataQueryRequest:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-http request" data-lang="http request">Request method:	POST
Request URI:	http://localhost:8082/internal/dookug/document/storedTemplate/metadata/query
Headers:		Accept=application/json
				Content-Type=application/json; charset=UTF-8</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "context": {
      "requestId": "43183LDKQNC2R702",
      "timestamp": "2023-02-22T09:15:14.168Z"
    },
    "paginationParams": {
      "rows": 10,
      "page": 1
    },
    "queryParams": {
      "status": "DONE",
      "storageMethod": "DATABASE",
      "filename": "filename.pdf",
      "format": "PDF",
      "templateId" : "MAIN_TEMPLATE"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If documents are found based on the submitted parameters, the response returns a list of up to 100 elements.</p>
</div>
<div class="paragraph">
<p>Sample DocumentMetadataQueryResponse:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "context": {
      "requestId": "43183LDKQNC2R702",
      "timestamp": "2023-02-22T09:15:14.168Z"
    },
    "funcCode": "OK",
    "rowList": [
      {
        "documentId": "43183KXXW2KCI206",
        "storageMethod": "DATABASE",
        "filename": "filename.pdf",
        "format": "PDF",
        "status" : "DONE"
      }
    ]
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="getDocument">2.1.1.9. Get Document</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">POST /internal/dookug/document/content/{documentId}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The purpose of this endpoint is to retrieve a previously generated and saved document based on the provided identifier.</p>
</div>
<div class="paragraph">
<p>Sample document retrieval request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Request method:	GET
Request URI:	http://localhost:8082/internal/dookug/document/content/43183KXXW2KCI206 <b class="conum">(1)</b>
Headers:		Content-Type=application/octet-stream</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Identifier of the generated document</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If no document is found for the submitted identifier, an ENTITY_NOT_FOUND error is returned.</p>
</div>
<div class="paragraph">
<p>In the response - for an existing document identifier - the generated document is returned, and the file name is included in the HTTP headers.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_openapi_documentation">2.2. OpenAPI Documentation</h3>
<div class="paragraph">
<p>Download OpenAPI Files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dookug-rest-service</p>
<div class="ulist">
<ul>
<li>
<p><a href="generated/openapi/dookug-document-service/openapi.yaml">yaml</a></p>
</li>
<li>
<p><a href="generated/openapi/dookug-document-service/openapi.json">json</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dookug_module_client">3. DookuG Module Client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The client aims to support management of the DookuG module, which encompasses various server-side methods.</p>
</div>
<div class="sect2">
<h3 id="_technology">3.1. Technology</h3>
<div class="ulist">
<ul>
<li>
<p>Java 17</p>
</li>
<li>
<p>JEE 10 (There is a client for supporting JEE 8)</p>
</li>
<li>
<p>Eclipse Microprofile 4.1 and 5.0</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_usage">3.2. Usage</h3>
<div class="paragraph">
<p>Using the client requires only an entry in the pom.xml file, depending on the desired JEE version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
   &lt;groupId&gt;hu.icellmobilsoft.dookug&lt;/groupId&gt;
   &lt;artifactId&gt;dookug-client-jee10&lt;/artifactId&gt;
   &lt;version&gt;${version.dookug.client}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
   &lt;groupId&gt;hu.icellmobilsoft.dookug&lt;/groupId&gt;
   &lt;artifactId&gt;dookug-client-jee8&lt;/artifactId&gt;
   &lt;version&gt;${version.dookug.client}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>followed by an @Inject,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Inject
private DookugClient dookugClient;</code></pre>
</div>
</div>
<div class="paragraph">
<p>which defines client calls to all endpoints and allows the use of its offered methods.
The API calls are made using the <a href="https://download.eclipse.org/microprofile/microprofile-rest-client-2.0/microprofile-rest-client-spec-2.0.html">MicroProfile Rest Client</a>, so configurations can be set using the familiar microprofile-config. (see below)</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>It is the responsibility of the client application to mount resources under the <code>/home/icellmobilsoft/resources</code> mount point within the container that it uses, which are referenced in the templates!</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="methods">3.3. Operation</h3>
<div class="paragraph">
<p>The client currently has multiple methods to generate documents, retrieve metadata of the created documents, and fetch the generated document itself.</p>
</div>
<div class="paragraph">
<p>During document generation, some methods return the generated document:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public GeneratedDocumentDto postDocumentGenerateEntityBody(Collection&lt;TemplateType&gt; templates, Collection&lt;ParameterType&gt; parameters) throws BaseException;

public GeneratedDocumentDto postDocumentGenerateEntityBody(Collection&lt;TemplateType&gt; templates, ParametersDataType parametersData) throws BaseException;

public GeneratedDocumentDto postDocumentGenerateEntityBody(Collection&lt;TemplateType&gt; templates) throws BaseException;

public GeneratedDocumentDto postDocumentGenerateMultipart(InputStream template, Collection&lt;ParameterType&gt; parameters) throws BaseException;

public GeneratedDocumentDto postDocumentGenerateMultipart(InputStream template, ParametersDataType parametersData) throws BaseException;

public GeneratedDocumentDto postDocumentGenerateMultipart(InputStream template) throws BaseException;

public GeneratedDocumentDto postDatabaseStoredTemplateDocumentGenerate(String templateName, OffsetDateTime templateValidity, Collection&lt;ParameterType&gt; parameters) throws BaseException;

public GeneratedDocumentDto postDatabaseStoredTemplateDocumentGenerate(String templateName, OffsetDateTime templateValidity, ParametersDataType parametersData) throws BaseException;</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is important to note that <code>ParametersDataType</code> type parameters can be created manually, but a <code>ParametersDataBuilder</code> helper class is provided to configure the desired settings using a fluent API. This was required by the SAXON template engine, as additional parameters are necessary for generating XSLT templates, without which documents cannot be generated. The desired configuration can be easily extracted from the builder for the SAXON engine by calling the <code>getSaxonParameters(byte[], byte[], boolean)</code> method, where the FOP configuration content, the XML dataset, and the compression status of the XML can be specified, or through overloaded methods, just the content of the XML file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">GeneratedDocumentDto resp = client.postDatabaseStoredTemplateDocumentGenerate(
        TemplateLanguageType.HU, <b class="conum">(1)</b>
        ParametersDataBuilder.getSaxonParameters(
                FileUtil.readFileFromResource(DocumentServiceTestConstant.XSLT_TEMPLATE_PARAMS).getBytes(StandardCharsets.UTF_8))); <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The language of the template</p>
</li>
<li>
<p>The content of the XML dataset (uncompressed in this case)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These methods return a <code>GeneratedDocumentDTO</code> upon a successful call, which contains the generated filename, the generated object as a stream, and the HTTP status code.</p>
</div>
<div class="paragraph">
<p>Parameters must include the list of templates and the parameters if the templates contain variables that need to be replaced with values, such as in the case of the HANDLEBARS template engine. The parameters can be key-value pairs or a JSON object that essentially contains these key-value pairs.</p>
</div>
<div class="paragraph">
<p>The methods differ in the way the template for document generation is provided.
In the <code>postDocumentGenerateEntityBody()</code> methods, the structure used as a template is sent in the request body. In the <code>postDocumentGenerateMultipart()</code> methods, the template is provided as a form parameter, InputStream. In the <code>postDatabaseStoredTemplateDocumentGenerate()</code> methods, only the template name needs to be provided, as the endpoint handles it according to the specified storage method.</p>
</div>
<div class="paragraph">
<p>Additionally, methods are available for generating documents where only the metadata of the created document is returned instead of the document itself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public DocumentMetadataResponse postDocumentGenerateEntityBodyMetadata(Collection&lt;TemplateType&gt; templates, Collection&lt;ParameterType&gt; parameters) throws BaseException;

public DocumentMetadataResponse postDocumentGenerateEntityBodyMetadata(Collection&lt;TemplateType&gt; templates, ParametersDataType parametersData) throws BaseException;

public DocumentMetadataResponse postDocumentGenerateEntityBodyMetadata(Collection&lt;TemplateType&gt; templates) throws BaseException;

public DocumentMetadataResponse postDocumentGenerateMultipartMetadata(InputStream template, Collection&lt;ParameterType&gt; parameters) throws BaseException;

public DocumentMetadataResponse postDocumentGenerateMultipartMetadata(InputStream template, ParametersDataType parametersData) throws BaseException;

public DocumentMetadataResponse postDocumentGenerateMultipartMetadata(InputStream template) throws BaseException;

public DocumentMetadataResponse postDatabaseStoredTemplateDocumentGenerateMetadata(String templateName, OffsetDateTime templateValidity, Collection&lt;ParameterType&gt; parameters) throws BaseException;

public DocumentMetadataResponse postDatabaseStoredTemplateDocumentGenerateMetadata(String templateName, OffsetDateTime templateValidity, ParametersDataType parametersData) throws BaseException;

public DocumentMetadataResponse postStoredTemplateDocumentGenerateMetadata(String templateName, OffsetDateTime templateValidity, TemplateStorageMethodType templateStorageMethodType, Collection&lt;ParameterType&gt; parameters, ParametersDataType parametersData) throws BaseException;</code></pre>
</div>
</div>
<div class="paragraph">
<p>These methods return a <code>DocumentMetadataResponse</code> upon a successful call, which includes the unique identifier of the document, filename, storage method, format, and status.</p>
</div>
<div class="paragraph">
<p>Similarly, the client calls are distinguished in the same way by how the template is provided.</p>
</div>
<div class="paragraph">
<p>To view already generated files, there is an option to query the metadata of the documents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public DocumentMetadataQueryResponse postDocumentMetadataQuery(DocumentMetadataQueryParamsType queryParams) throws BaseException;

public DocumentMetadataQueryResponse postDocumentMetadataQuery(DocumentMetadataQueryRequest queryRequest) throws BaseException;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The query returns a <code>DocumentMetadataQueryResponse</code> upon a successful call, which contains the metadata of documents matching the specified parameters, as well as pagination data: total number of items, total number of pages, page number, and the number of items returned in the query.</p>
</div>
<div class="paragraph">
<p>Filtering conditions can include the document name, format, storage method, template identifier from which the document was generated, the identifier of the document&#8217;s storage, and the status of the document.</p>
</div>
<div class="paragraph">
<p>It is also possible to query a previously generated document:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public GeneratedDocumentDto getDocumentContent(String documentId) throws BaseException;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response returns the generated document as a stream, the filename, and the HTTP status code upon a successful call.</p>
</div>
<div class="paragraph">
<p>The unique identifier of the document must be provided as a parameter.</p>
</div>
<div class="paragraph">
<p>The client also offers additional configuration options that can influence the generation process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">setGeneratorEngineType()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">setTemplateEngineType()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">setResponseFormat()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">setDocumentStorageMethodType()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">setDigitalSigningType()</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>setGeneratorEngineType()</code> allows setting the engine used for output generation, which currently can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PDF_BOX</code>&#8201;&#8212;&#8201;uses [Apache PdfBox](<a href="https://pdfbox.apache.org/" class="bare">https://pdfbox.apache.org/</a>)</p>
</li>
<li>
<p><code>SAXON</code>&#8201;&#8212;&#8201;uses [Saxon HE](<a href="https://github.com/Saxonica/Saxon-HE/" class="bare">https://github.com/Saxonica/Saxon-HE/</a>)</p>
</li>
<li>
<p><code>NONE</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>setTemplateEngineType()</code> allows setting the template 'type', which currently can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>HANDLEBARS</code>&#8201;&#8212;&#8201;uses [Handlebars](<a href="https://handlebarsjs.com/" class="bare">https://handlebarsjs.com/</a>)</p>
</li>
<li>
<p><code>NONE</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>setResponseFormat()</code> allows setting the response format:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PDF</code></p>
</li>
<li>
<p><code>STRING</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>setDocumentStorageMethodType()</code> allows setting the document storage method:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NONE</code></p>
</li>
<li>
<p><code>DATABASE</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>setDigitalSigningType(digitalSigningType)</code> allows controlling whether the generated PDF document should have a digital signature. The <code>digitalSigning</code> expects three additional parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>signatureName</code> - the name of the signature (optional)</p>
</li>
<li>
<p><code>signatureReason</code> - the reason for signing (optional)</p>
</li>
<li>
<p><code>keyAlias</code> - the identifier of the key in the keystore, used to identify the signing key (optional, but recommended as it defaults to searching for the <code>test</code> key)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If no settings are specified, the default values are <code>PDF_BOX</code> + <code>HANDLEBARS</code> + <code>PDF</code> + <code>NONE</code> without a digital signature.</p>
</div>
<div class="paragraph">
<p>The <code>postDocumentGenerateEntityBody()</code> methods call the following REST endpoint in the module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">POST /internal/dookug/document/generate/inline</code></pre>
</div>
</div>
<div class="paragraph">
<p>The client sends:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ContextType</code></p>
</li>
<li>
<p>the received <code>TemplateType</code> list</p>
</li>
<li>
<p>the received <code>ParameterType</code> list</p>
</li>
<li>
<p>the <code>GeneratorSetup</code> object, which can be controlled by the client&#8217;s <code>set</code> methods.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the request is correct, the generated object is returned.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For Multipart and StoredTemplate clients, the process is the same, differing only in the REST API calls.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>postDocumentMetadataQuery()</code> methods call the following REST endpoint in the module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">POST /internal/dookug/document/storedTemplate/metadata/query</code></pre>
</div>
</div>
<div class="paragraph">
<p>The client sends:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ContextType</code></p>
</li>
<li>
<p>the received filtering conditions</p>
</li>
<li>
<p>pagination parameters</p>
</li>
<li>
<p>sorting settings</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the request is correct, the metadata of the documents matching the specified parameters is returned.</p>
</div>
<div class="paragraph">
<p>Example of client usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"> @Inject
 private DookugClient dookugClient;
 ...
 //template object
 TemplateType template = new TemplateType().withTemplateName("main").withTemplateContent("DookuG client simple test with parameters first: [{{first}}], second: [{{second}}]".getBytes(StandardCharsets.UTF_8));

 //parameters
 ParameterType parameter1 = new ParameterType().withKey("first").withValue("első");
 ParameterType parameter2 = new ParameterType().withKey("second").withValue("í189öüóőúűáé-.,&lt;&gt;#&amp;@{};*¤ß$");
 ...
 client.setResponseFormatType(ResponseFormatType.STRING);
 client.setGeneratorEngineType(GeneratorEngineType.NONE);
 GeneratedDocumentDto response = dookugClient.postDocumentGenerateEntityBody(List.of(template), List.of(parameter1,parameter2));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or similarly, generating a document but with a PDF document format, multipart input, and returning the metadata:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"> @Inject
 private DookugClient dookugMultipartClient;
 ...
 //template as byte array
 byte[] template = "DookuG client simple test with parameters first: [{{first}}], second: [{{second}}]".getBytes(StandardCharsets.UTF_8);

 //parameters
 ParameterType parameter1 = new ParameterType().withKey("first").withValue("első");
 ParameterType parameter2 = new ParameterType().withKey("second").withValue("í189öüóőúűáé-.,&lt;&gt;#&amp;@{};*¤ß$");
 ...
 client.setResponseFormatType(ResponseFormatType.PDF); //ez a default
 client.setGeneratorEngineType(GeneratorEngineType.PDF_BOX); //ez a default
 client.setTemplateEngineType(GeneratorEngineType.HANDLEBARS); //ez a default
 DocumentMetadataResponse response = dookugMultipartClient.postDocumentGenerateMultipartMetadata(new ByteArrayInputStream(template), List.of(parameter1, parameter2));</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_using_saxon_he_engine_in_the_client">3.3.1. Using Saxon-HE Engine in the Client</h5>
<div class="paragraph">
<p>To use the Saxon-HE engine in the client, an XSLT template is required for generating a PDF file from an XML. In this case, only PDF can be the output format. You also need to provide a <code>fop-config.xml</code> file in the request, which helps regulate the use of fonts, for example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;fop version="1.0"&gt;
    &lt;renderers&gt;
        &lt;renderer mime="application/pdf"&gt;
            &lt;fonts&gt;
                &lt;!-- TTF fonts --&gt;
                &lt;font kerning="yes" embed-url="/home/icellmobilsoft/fonts/Roboto/Roboto-Regular.ttf"&gt;
                    &lt;font-triplet name="Roboto" style="normal" weight="normal" /&gt;
                &lt;/font&gt;
                &lt;font kerning="yes" embed-url="/home/icellmobilsoft/fonts/Roboto/Roboto-Bold.ttf"&gt;
                    &lt;font-triplet name="Roboto" style="normal" weight="bold" /&gt;
                &lt;/font&gt;
            &lt;/fonts&gt;
        &lt;/renderer&gt;
    &lt;/renderers&gt;
&lt;/fop&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Handlebars can also be used with SAXON, where you can substitute the usual <code>{{VARIABLE}}</code> variables with desired text parts, as well as create nested templates (this is mainly used for that).</p>
</div>
<div class="paragraph">
<p>The major change from other engines is that you need to specify the <code>XML</code> as a data source in the <code>generatorSetup</code> in the SAXON case, in addition to other fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XML: as data source</p>
</li>
<li>
<p>XSLT: as template</p>
</li>
<li>
<p>fopConfig: transformer configuration</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_error_handling">3.4. Error Handling</h3>
<div class="paragraph">
<p>The client can only return a BaseException, but if a RestClientResponseException is received during the API call, it will return the wrapped BaseException contained within it!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">4. Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_backend_2">4.1. Backend</h3>
<div class="paragraph">
<p>The module&#8217;s configuration is managed via MicroProfile Config, which allows specifying necessary values in multiple ways.</p>
</div>
<div class="paragraph">
<p>MicroProfile Config can retrieve a given key from all available sources and uses the highest priority value.</p>
</div>
<div class="paragraph">
<p>The base configuration is provided via <code>project-defaults.yml</code>, which can be extended and may vary per environment. It&#8217;s not necessary to specify every value; only those that differ from the default settings.</p>
</div>
<div class="paragraph">
<p><strong>Possible modes in order of priority:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>System variables</p>
</li>
<li>
<p>Environment variables</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_dookug_document_service_2">4.1.1. DOOKUG-DOCUMENT service</h4>
<div class="paragraph">
<p>The meanings of the emojis used in the table:</p>
</div>
<div class="paragraph">
<p>🚀 - meaning that it is a startup parameter.</p>
</div>
<div class="paragraph">
<p>⏳ - meaning that this parameter can be overridden during runtime</p>
</div>
<div class="sect5">
<h6 id="_dookug_keys">dookug keys</h6>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 37.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Since</th>
<th class="tableblock halign-left valign-top">Features</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.client.document</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Client configuration</strong></p>
<p class="tableblock"> In the application using the DookuG client, you need to set:</p>
<p class="tableblock"> - the server REST URL (e.g., dookug.client.document/mp-rest/url: <a href="http://localhost:8082" class="bare">http://localhost:8082</a>)</p>
<p class="tableblock"> - optionally the REST connectTimeout (e.g., dookug.client.document/mp-rest/connectTimeout: 5000)</p>
<p class="tableblock"> - optionally the REST readTimeout (e.g., dookug.client.document/mp-rest/readTimeout: 60000)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.cache.keystore.enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Cache.Keystore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Does the module use keystore caching for document signing?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.cache.keystore.enablestatistic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Cache.Keystore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metrics related to the Template cache should be generated. By default, they are not generated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.cache.keystore.ttl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Cache.Keystore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How long until the system invalidates the cache content. By default, 1440 minutes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1440</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.cache.template.enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Cache.Template</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Does the module use template caching?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.cache.template.enablestatistic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Cache.Template</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metrics related to the Template cache should be generated. By default, they are not generated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.cache.template.ttl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Cache.Template</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How long until the system invalidates the cache content. By default, 60 minutes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.engine.handlebars.escapingstrategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Handlebars.EscapingStrategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Handlebars configuration</strong></p>
<p class="tableblock"> Configuration storing the <code>com.github.jknack.handlebars.EscapingStrategy</code> key.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In the Handlebars engine, HTML will be the default strategy if no value is configured with this key.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.engine.handlebars.helper.javascript.directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Handlebars.Helper</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Handlebars configuration</strong></p>
<p class="tableblock"> Stores the path to the directory containing JavaScript files with Handlebars handlers in the Docker container.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/home/icellmobilsoft/handlebars/helper/js</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.engine.saxon.fopconfig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Saxon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Saxon configuration</strong></p>
<p class="tableblock"> Path to the Fop config file within the container</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/home/icellmobilsoft/fop-config/fop-config.xml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.engine.saxon.xslt.language.default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Saxon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Saxon configuration</strong></p>
<p class="tableblock"> Default language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.engine.saxon.xslt.language.variable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Saxon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Saxon configuration</strong></p>
<p class="tableblock"> The name of the language variable in the XSLT template</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lang</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.interface.parametersdata.gzipped</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hu.icellmobilsoft.dookug.api.dto.constants.ConfigKeys.Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Interface configuration</strong></p>
<p class="tableblock"> Logical config key.</p>
<p class="tableblock"> The module expects the incoming "parametersData" field in the request to be compressed using gzip.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="pdfSignatureConfiguration">4.1.2. Pdf Signature configuration</h4>
<div class="paragraph">
<p>Unresolved directive in config/backend.adoc - include::../generated/dookug-pdf-signature-config.adoc[leveloffset=+1]</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_client">4.2. Client</h3>
<div class="paragraph">
<p>The operation of the client can be influenced using MicroProfile Config.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">dookug:
    client:
        document/mp-rest/url: http://localhost:8082
        document/mp-rest/connectTimeout: 5000 #millisec
        document/mp-rest/readTimeout: 60000 #millisec</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is advisable to specify the following parameters for the client operation:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter Key</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.client.document/mp-rest/url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base URL of the DookuG module</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.client.document/mp-rest/connectTimeout</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection Timeout (defaults to 5 seconds if unspecified)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.client.document/mp-rest/readTimeout</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read Timeout (defaults to 1 minute if unspecified)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.cache.template.ttl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Template cache expiration time in minutes, default is 60 minutes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dookug.service.cache.template.enablestatistic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to generate metrics for caching, defaults to false</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Additional parameters can also be specified, as outlined in the [Microprofile RestClient documentation](<a href="https://download.eclipse.org/microprofile/microprofile-rest-client-2.0/microprofile-rest-client-spec-2.0.html#mpconfig:~:text=Client%20CDI%20Support-,Support%20for%20MicroProfile%20Config,-Configuration%20Keys" class="bare">https://download.eclipse.org/microprofile/microprofile-rest-client-2.0/microprofile-rest-client-spec-2.0.html#mpconfig:~:text=Client%20CDI%20Support-,Support%20for%20MicroProfile%20Config,-Configuration%20Keys</a>).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation_deployment">5. Installation, Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Dookug module must be accessible in the environments of the project(s) that intend to utilize the service.
Each instance of the service, along with its infrastructure requirements, should be installed and configured for every environment (development/test/production).</p>
</div>
<div class="sect2">
<h3 id="_dookug_document_service_3">5.1. DOOKUG-DOCUMENT Service</h3>
<div class="sect3">
<h4 id="_service_configuration">5.1.1. Service configuration</h4>
<div class="listingblock">
<div class="title">Interface</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">DOOKUG_SERVICE_INTERFACE_PARAMETERSDATA_GZIPPED=true</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">PDF signing</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">DOOKUG_SERVICE_ENGINE_PDF_DIGITALSIGN_SIGNATURE_DEFAULT_NAME="Original document"
DOOKUG_SERVICE_ENGINE_PDF_DIGITALSIGN_SIGNATURE_DEFAULT_REASON="Certified by Dookug"
DOOKUG_SERVICE_ENGINE_PDF_DIGITALSIGN_SIGNATURE_DEFAULT_KEYSTORE=/home/icellmobilsoft/keys/keystore.p12
DOOKUG_SERVICE_ENGINE_PDF_DIGITALSIGN_SIGNATURE_DEFAULT_KEYSTOREPASS=123456
DOOKUG_SERVICE_ENGINE_PDF_DIGITALSIGN_SIGNATURE_DEFAULT_KEYSTORETYPE=PKCS12</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Saxon</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">DOOKUG_SERVICE_ENGINE_SAXON_FOPCONFIG=/home/icellmobilsoft/fop-config/fop-config.xml
DOOKUG_SERVICE_ENGINE_SAXON_XSLT_LANGUAGE_VARIABLE=lang
DOOKUG_SERVICE_ENGINE_SAXON_XSLT_LANGUAGE_DEFAULT=HU</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Handlebars</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">DOOKUG_SERVICE_ENGINE_HANDLEBARS_HELPER_JAVASCRIPT_DIRECTORY=/home/icellmobilsoft/handlebars/helper/js
DOOKUG_SERVICE_ENGINE_HANDLEBARS_ESCAPINGSTRATEGY=HTML_ENTITY</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_recommended_k8s_configuration">5.1.2. Recommended K8S Configuration</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAVA_OPTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Xms2000m -Xmx2000m -XX:MetaspaceSize=96M -XX:MaxMetaspaceSize=256m -XX:+PrintCommandLineFlags -XX:+UseG1GC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximize module heap requirement to 2G memory with UseG1GC algorithm.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Requests/limits settings</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  containers:
    resources:
      limits:
        cpu: "3"
        memory: 3G
      requests:
        cpu: "3"
        memory: 3G</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_observability">5.1.3. Observability</h4>
<div class="sect4">
<h5 id="_health_startuplivenessreadiness">5.1.3.1. Health - startup/liveness/readiness</h5>
<div class="paragraph">
<p>The service supports the use of K8S probes.</p>
</div>
<div class="paragraph">
<p>Started: <a href="http://localhost:9990/health/started" class="bare">http://localhost:9990/health/started</a></p>
</div>
<div class="paragraph">
<p>Live: <a href="http://localhost:9990/health/live" class="bare">http://localhost:9990/health/live</a></p>
</div>
<div class="paragraph">
<p>Ready: <a href="http://localhost:9990/health/ready" class="bare">http://localhost:9990/health/ready</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_informations">6. Additional informations</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_template_cache">6.1. Template Cache</h3>
<div class="paragraph">
<p>The application caches the TEMPLATE data stored in the database using GUAVA. The caches have a defined lifespan, and the time resets with each new request.</p>
</div>
<div class="paragraph">
<p><strong>Configuration Parameters:</strong></p>
</div>
<div class="paragraph">
<p>You can specify the duration for which templates are kept in the cache using the DOOKUG_SERVICE_CACHE_TEMPLATE_TTL parameter, in minutes. The default is 60 minutes.</p>
</div>
<div class="paragraph">
<p>You can specify whether metrics generation is needed using the DOOKUG_SERVICE_CACHE_TEMPLATE_ENABLESTATISTIC parameter. The default is false, meaning no metrics are generated.</p>
</div>
<div class="paragraph">
<p>Metrics similar to the following are generated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># TYPE application_cache_hit_count gauge
application_cache_hit_count{name="template"} 0.0
# TYPE application_cache_miss_count gauge
application_cache_miss_count{name="template"} 1.0
# TYPE application_cache_size gauge
application_cache_size{name="template"} 1.0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_helpers_helper_functions_for_use_in_template_files">6.2. Helpers - Helper Functions for Use in Template Files</h3>
<div class="sect3">
<h4 id="_built_in_helpers">6.2.1. Built-in Helpers</h4>
<div class="paragraph">
<p>Handlebars provides built-in helpers, whose documentation can be found <a href="https://handlebarsjs.com/guide/builtin-helpers.html">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_custom_helpers">6.2.2. Custom Helpers</h4>
<div class="paragraph">
<p>It is possible to use general helpers provided by the module. In the examples, the &#8230;&#8203; parts render if the expression evaluates to true.</p>
</div>
<div class="sect4">
<h5 id="_usage_2">6.2.2.1. Usage</h5>
<div class="paragraph">
<p>When using helpers, specify the parameters for the given helper after the helper keyword. Helpers can be used during inline generation and database-stored template-based generation. The parameters can be hardcoded values or come in JSON format during the document generation call.</p>
</div>
<div class="paragraph">
<p>Helpers can be combined with each other.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 5%;">
<col style="width: 45%;">
<col style="width: 45%;">
<col style="width: 5%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Usage</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Available from Version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">equals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compares the values of two elements; renders if the evaluation is true.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">{{#if (equals yourField 'white')}} ... {{/if}}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">before</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renders if the provided parameter is an earlier date than the given value. The latter can also be a parameter.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">{{#if (before yourDate '2023-08-13T05:40:55Z')}} ... {{/if}}
{{#if (before yourDate checkDate)}} ... {{/if}}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">between</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renders if the provided parameter falls between the two given date values. The latter can also be parameters.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">{{#if (between yourDate '2023-08-13T05:40:55Z' '2023-08-15T05:40:55Z')}} ... {{/if}}
{{#if (between yourDate startDate endDate)}} ... {{/if}}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dateMinusMinutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subtracts a given number of minutes from the specified date.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">{{dateMinusMinutes '2023-08-13T05:40:55Z' 60}}    // evaluates to '2023-08-13T04:40:55Z'
{{dateMinusMinutes yourDate 60}}                  // The following two examples evaluate to the same date
{{dateMinusMinutes yourDate minutesToSubtract}}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">datePlusMinutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The counterpart to dateMinusMinutes, it adds minutes to the given date.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">{{datePlusMinutes '2023-08-13T05:40:55Z' 60}} - evaluates to '2023-08-13T06:40:55Z'
{{datePlusMinutes yourDate 60}}
{{datePlusMinutes yourDate minutesToAdd}}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">declare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creates a new variable and immediately renders it. The created variables are global, regardless of where they were created in the templates.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">{{declare 'myColor' 'white'}}       // immediately renders the word 'white'
...
{{#if myColor}} {{myColor}} {{/if}} // renders 'white'</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">declareVoid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Works similarly to the declare helper, but does not immediately render the given value. declare can be replaced by declareVoid followed by immediate invocation.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">{{declareVoid 'myColor' 'white'}}
...
{{#if myColor}} {{myColor}} {{/if}}  // renders 'white'
Replacing declare with declareVoid:
{{declareVoid 'myColor' 'white'}}
{{myColor}}   // renders 'white' immediately after creation</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">formatDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transforms the given parameter, accepted in Java 8 date format, according to the specified pattern. The pattern only accepts date formats; otherwise, it throws an error.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">yourDate = '2024-01-09';

{{formatDate '2023-08-13' 'yyyy.MM.dd'}}         // '2023.08.13'
{{formatDate '2023-08-13' 'MM.dd.yyyy'}}         // '08.13.2023'
{{formatDate yourDate 'yyyy/MM/dd'}}             // '2024/01/09'</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">formatDateTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transforms the given parameter, accepted in Java 8 date and time format, according to the specified pattern. The helper handles full ISO date format input and can generate appropriate output using the pattern. The helper can also handle time zones; if a Java-accepted Zone ID is provided after the output pattern, it converts the input time to the time zone&#8217;s output.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">yourDate = '2024-01-09T15:30:04Z'
yourDateTimeFormat = 'MM.dd-HH:mm'
yourDateFormat = 'yyyy/MM.dd'
yourTimeFormat = 'hh:mm:ss a'

{{formatDateTime '2023-08-13T05:40:55Z' 'yyyy-MM-dd HH:mm:ss'}}         // '2023-08-13 06:40:55'
{{formatDateTime yourDate 'yyyy-MM-dd HH:mm:ss'}}                       // '2024-01-09 15:30:04'
{{formatDateTime yourDate yourDateTimeFormat}}                          // '01.09-15:30'
{{formatDateTime yourDate yourDateFormat}}                              // '2024/01.09'
{{formatDateTime yourDate yourTimeFormat}}                              // '03:30:04 PM'
{{formatDateTime '2023-08-13T05:40:55Z' 'yyyy-MM-dd HH:mm:ss' 'CET'}}   // '2023-08-13 08:40:55'</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">formatTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transforms the given parameter, accepted in Java 8 time format, according to the specified pattern. The pattern only accepts time formats; otherwise, it throws an error.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">yourTime = '15:30:55Z';

{{formatTime '15:30:55Z' 'HH:mm:ss'}}         // '15:30:55'
{{formatTime yourTime 'h:mm A'}}              // '3:30 PM'</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">formatNumber</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Helper used for formatting numbers, following Java number formatting conventions.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">number = 1234.567;
percentage = 0.4567

{{formatNumber number '#'}}         // "1235", rounded integer
{{formatNumber number '0.00'}}      // "1234.57", number rounded to 2 decimals
{{formatNumber number '000000.00'}} // "001234.57", number padded with leading zeros
{{formatNumber number '#,###.##'}}  // "1,234.57", comma-separated, grouped by thousands
{{formatNumber number '$#,##0.00'}} // "$1,234.57", currency expression
{{formatNumber percentage '0.00%'}} // "45.67%", percentage expression of a value between 0 and 1
{{formatNumber number '0.###E0'}}   // "1.235E8", number in scientific notation</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">and</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical AND operator for N values. Renders if the logical AND operator evaluates to true.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">{{#if (and falseValue trueValue notExistingValue)}} YES {{else}} NO {{/if}}               // renders "NO"
{{#if (and trueValue trueValue trueValue)}} YES {{/if}}                                   // renders "YES" since all three values are true
myValue = 'black'
{{#if (and (equals myValue 'black')}} YES {{else}} NO {{/if}}                             // renders "YES", both the variable and the string evaluation are true
{{#if (and (equals myValue 'white')}} YES {{else}} NO {{/if}}                             // renders "NO", both the variable and the string evaluation are false

Combined usage:
{{#if (and (equals 'black' 'white') (equals 'white' 'white'))}} YES {{else}} NO {{/if}}   // renders "NO", the first is false, the second is true</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">or</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical OR operator for N values. Renders if the logical OR operator evaluates to true.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">{{#if (or falseValue trueValue notExistingValue)}} YES {{else}} NO {{/if}}               // renders "YES"
{{#if (or falseValue falseValue falseValue)}} YES {{/if}}                                // renders nothing
myValue = 'white'
{{#if (or myValue1 myValue2)}} YES {{else}} NO {{/if}}                                   // renders "YES" if myValue1 OR myValue2 is defined (not null)

Combined usage:
{{#if (or (equals 'black' 'white') (equals 'white' 'white'))}} YES {{else}} NO {{/if}}   // renders "YES", false OR true evaluates to true</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">not</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical NOT operator. Negates the given parameter; renders if the evaluation is true, otherwise does not render.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">{{#if (not falseValue)}} YES {{else}} NO {{/if}}                // YES
{{#if (not existingValue)}} YES {{else}} NO {{/if}}             // NO
{{#if (not (equals 'black' 'white'))}} YES {{else}} NO {{/if}}  // YES</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">in</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checks if the first parameter matches any of the subsequent elements</p>
<p class="tableblock">.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">myValue = 'white'
{{#if (in myValue 'black' 'gray')}} YES {{else}} NO {{/if}}           // NO
{{#if (in myValue 'black' 'white' 'gray')}} YES {{else}} NO {{/if}}   // YES</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">math</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Helper for basic mathematical operations. The first parameter is the operator, and the other two parameters are the operands. The list of usable operators:</p>
<p class="tableblock">“+”, “-”, “*”, “/”, “%”</p>
<p class="tableblock">If an invalid operator is used, the evaluation result is: “-1”. Otherwise, the result of the mathematical operation on the operands corresponding to the operator.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">num1 = 5
num2 = 8
num3 = 100
num4 = 20

{{math '+' num1 num2}}  // 13
{{math '-' num3 53}}    // 47
{{math '*' num2 num4}}  // 160
{{math '/' num3 num4}}  // 5
{{math '%' num4 num2}}  // 40
{{math 'A' num1 num2}}  // -1</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_additional_helper_functions">6.2.2.2. Additional Helper Functions</h5>
<div class="paragraph">
<p>The following 3rd party helper functions can be used in the project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/jknack/handlebars.java/blob/v4.3.1/handlebars/src/main/java/com/github/jknack/handlebars/helper/StringHelpers.java">StringHelpers</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_custom_fonts">6.3. Using Custom Fonts</h3>
<div class="paragraph">
<p>This documentation is intended for the <a href="https://pdfbox.apache.org/">Apache PDFBox</a> engine and focuses on using custom fonts.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>A limitation of the engine is that it can only embed TTF fonts. Additionally, if you want to use weight, styles, and variants settings, it is worth noting that PDFBox cannot always emulate these properly unless you load different variations of the font.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the docker-compose file, we add the <code>fonts</code> directory to our image as <code>/home/icellmobilsoft/fonts</code>, so we can access the fonts in this directory locally from the templates.</p>
</div>
<div class="paragraph">
<p>We have two options for using custom fonts.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Load the font directly in the CSS</p>
</li>
<li>
<p>Load the font programmatically, then reference it in the CSS using <code>font-family</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the first option, you can specify the font&#8217;s location in the CSS within the <code>@font-face</code> at-rule using the <code>src: url()</code> descriptor.</p>
</div>
<div class="paragraph">
<p>In this case, internet access will be required during generation, which may not always be possible as the company&#8217;s policy may prohibit the module from accessing external URLs.</p>
</div>
<div class="paragraph">
<p>This can be mitigated either by making the fonts accessible through an internal URL or by preloading some frequently used fonts in the module and referencing their local availability using a <code>file://</code> URL.
If the module will contain preloaded fonts, it is advisable to mention this in the documentation or provide the information through an endpoint.</p>
</div>
<div class="paragraph">
<p>TEMPLATE:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;style&gt;
    @font-face {
        font-family: 'Cairo';
        font-style: normal;
        src: url(file:/home/icellmobilsoft/fonts/Cairo/Cairo-Regular.ttf); // <b class="conum">(1)</b>
    }

    @font-face {
        font-family: 'IndieFlower';
        font-style: normal;
        src: url(file:fonts/IndieFlower/IndieFlower-Regular.ttf); // <b class="conum">(2)</b>
    }
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Loading Cairo-Regular.ttf from the <code>/home/icellmobilsoft/fonts</code> directory.</p>
</li>
<li>
<p>Here we also load the font from the above directory. The server considers <code>/home/icellmobilsoft</code> as the root, so the relative path works.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Using Google Fonts</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;style&gt;
    @import url('https://fonts.googleapis.com/css?family=Quicksand&amp;amp;display=swap'); // <b class="conum">(1)</b>

    .quicksand { // <b class="conum">(2)</b>
      font-family: 'Quicksand', Arial;
      font-weight: 700;
      font-style: normal;
      font-size: 38px;
      line-height: 1.15;
      letter-spacing: -.02em;
      color: rgba(0, 0, 0, 0.8);
      -webkit-font-smoothing: antialiased;
    }
&lt;/style&gt;
...
&lt;p class="quicksand"&gt;Google Quicksand Font úőüöóéáyí&lt;/p&gt; // <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Importing the Quicksand font from <a href="https://fonts.google.com/">Google Fonts</a></p>
</li>
<li>
<p>Setting the CSS class to use the font</p>
</li>
<li>
<p>Displaying text with the specified font</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If we want to load fonts programmatically from the file system, we can use the <code>builder.useFonts</code> method during rendering, which we can reference in the CSS.</p>
</div>
<div class="paragraph">
<p>JAVA:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">builder.useFont(new File("fonts/NotoSansThai/NotoSansThai-Regular.ttf"), "notosansthai-regular"); // <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Loading NotoSansThai-Regular.ttf</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>TEMPLATE:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;style&gt;
    @font-face {
        font-family: 'notosansthai-regular'; // <b class="conum">(1)</b>
        font-style: normal;
        -fs-font-subset: complete-font; // <b class="conum">(2)</b>
    }
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Using the previously loaded font</p>
</li>
<li>
<p>This is just an example; this setting is not really necessary as it embeds the entire font, whereas by default only the subset is embedded, which is the correct operation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The downside is that all fonts are loaded during rendering, even those not used in the document template.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The PDFBox Fonts Wiki is available <a href="https://github.com/danfickle/openhtmltopdf/wiki/Fonts">here</a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_digitally_signing_pdfs">6.4. Digitally Signing PDFs</h3>
<div class="paragraph">
<p>This documentation is intended for the <a href="https://pdfbox.apache.org/">Apache PDFBox</a> engine and describes the process of digitally signing PDFs using a self-signed certificate, which is added to the image as <code>/home/icellmobilsoft/keys/keystore.p12</code> using the docker-compose file.</p>
</div>
<div class="paragraph">
<p>The keystore is located in the <code>/etc/docker-compose/keys</code> folder and was created on November 7, 2023, with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">keytool -genkeypair -storepass 123456 -storetype pkcs12 -alias test -validity 10958 -v -keyalg RSA -keystore keystore.p12</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>This means it will expire on November 7, 2053.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_configuration_2">6.4.1. Configuration</h4>
<div class="paragraph">
<p>The signature can be requested in the API calls within the GeneratorSetup request. Here you can specify the <code>signatureName</code>, <code>signatureReason</code>, and the private key alias (<code>keyAlias</code>) in case the keystore file contains multiple private keys.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">...
&lt;ns2:generatorSetup&gt;
    &lt;ns2:generatorEngine&gt;PDF_BOX&lt;/ns2:generatorEngine&gt;
    &lt;ns2:templateEngine&gt;NONE&lt;/ns2:templateEngine&gt;
    &lt;ns2:responseFormat&gt;PDF&lt;/ns2:responseFormat&gt;
    &lt;ns2:digitalSignatureProfile&gt;sampleProfile&lt;/ns2:digitalSignatureProfile&gt; <b class="conum">(1)</b>
        ...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The name of the signature profile only in case you need PDF signing</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The signature can be customized with the following configuration keys:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">dookug:
  service:
    engine:
      pdf:
        digitalsign:
          sampleProfile: <b class="conum">(1)</b>
            name: Example Ltd. <b class="conum">(2)</b>
            reason: Certified <b class="conum">(2)</b>
            keystore: /home/icellmobilsoft/keys/keystore.p12 <b class="conum">(3)</b>
            keystorePass: 123456 <b class="conum">(4)</b>
            keystoreType: PKCS12 <b class="conum">(4)</b>
            keyAlias: key_test <b class="conum">(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>the name of the signatureProfile</p>
</li>
<li>
<p><code>name</code> and <code>reason</code> default values are used if the request does not contain these values.</p>
</li>
<li>
<p><code>keystore</code> is mandatory and specifies the location of the signing keys.</p>
</li>
<li>
<p><code>keystorePass</code> and <code>keystoreType</code> specify the password and type of the keystore file, respectively. These are also mandatory.</p>
</li>
<li>
<p>the identifier of the private key within the keystore</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_visible_signature_using_the_eu_dss_esign_library">6.4.2. Visible signature (using the EU DSS ESIGN library)</h4>
<div class="paragraph">
<p>In case you want to add visible (clickable) signature to the PDF document you need to add some extra configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dookug:
  service:
    engine:
      pdf:
        digitalsign:
          sampleProfile:
            keystore: /home/icellmobilsoft/keys/keystore.p12 <b class="conum">(3)</b>
            keystorePass: 123456
            keystoreType: PKCS12
            keyAlias: key_test
            dss: <b class="conum">(1)</b>
              imageFile: /home/icellmobilsoft/pdfsign/sample/signature.png <b class="conum">(2)</b>
              showOnPage: 1 <b class="conum">(3)</b>
              position:
                left: 18 <b class="conum">(4)</b>
                top: 2 <b class="conum">(5)</b>
              width: 2 <b class="conum">(6)</b>
              useTimestamp: false <b class="conum">(7)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>the key for DSS library</p>
</li>
<li>
<p>the image you want to add to the document</p>
</li>
<li>
<p>the image will added to this page: <code>-1</code>: last page, <code>1</code>:first page, <code>0</code>:wont add, <code>n</code>:n-th page</p>
</li>
<li>
<p>X position of the image in cm (from top left corner)</p>
</li>
<li>
<p>Y position of the image in cm (from top left corner)</p>
</li>
<li>
<p>the width of the image in cm</p>
</li>
<li>
<p>you can add the signature timestamp to the image</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The available configuration keys can be found <a href="#pdfSignatureConfiguration">here</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_keystore_cache_for_digital_signature">6.5. Keystore Cache for digital signature</h3>
<div class="paragraph">
<p>The application caches the keystore data configured for signature profiles using GUAVA. The caches have a defined lifespan, and the time resets with each new request.</p>
</div>
<div class="paragraph">
<p><strong>Configuration Parameters:</strong></p>
</div>
<div class="paragraph">
<p>You can specify the duration for which templates are kept in the cache using the DOOKUG_SERVICE_CACHE_KEYSTORE_TTL parameter, in minutes. The default is 1440 minutes (1 day).</p>
</div>
<div class="paragraph">
<p>You can specify whether metrics generation is needed using the DOOKUG_SERVICE_CACHE_KEYSTORE_ENABLESTATISTIC parameter. The default is false, meaning no metrics are generated.</p>
</div>
<div class="paragraph">
<p>Metrics similar to the following are generated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># TYPE application_cache_hit_count gauge
application_cache_hit_count{name="keystore"} 0.0
# TYPE application_cache_miss_count gauge
application_cache_miss_count{name="keystore"} 1.0
# TYPE application_cache_size gauge
application_cache_size{name="keystore"} 1.0</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_release_notes">7. Release notes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_v0_4_0">7.1. v0.4.0</h3>
<div class="paragraph">
<p>The project has been released on GitHub opensource.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>maven pom change:</p>
<div class="ulist">
<ul>
<li>
<p><code>&lt;groupId&gt;hu.icellmobilsoft.dookug.common&lt;/groupId&gt;</code> &#8594; <code>&lt;groupId&gt;hu.icellmobilsoft.dookug&lt;/groupId&gt;</code></p>
</li>
<li>
<p><code>&lt;groupId&gt;hu.icellmobilsoft.dookug.document&lt;/groupId&gt;</code> &#8594; <code>&lt;groupId&gt;hu.icellmobilsoft.dookug&lt;/groupId&gt;</code></p>
</li>
<li>
<p><code>&lt;groupId&gt;hu.icellmobilsoft.dookug.client&lt;/groupId&gt;</code> &#8594; <code>&lt;groupId&gt;hu.icellmobilsoft.dookug&lt;/groupId&gt;</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_v0_5_0">7.2. v0.5.0</h3>
<div class="sect3">
<h4 id="_changes_updates">7.2.1. Changes / updates</h4>
<div class="ulist">
<ul>
<li>
<p>Caching of templates in memory <a href="https://github.com/i-Cell-Mobilsoft-Open-Source/DookuG-backend/issues/4" class="bare">https://github.com/i-Cell-Mobilsoft-Open-Source/DookuG-backend/issues/4</a></p>
</li>
<li>
<p>Observability: DB health check added</p>
</li>
<li>
<p>TemplateLanguage type has been changed from enum to string (<code>EN</code> &#8594; <code>EN</code> or <code>en_GB</code>).</p>
</li>
<li>
<p>The jandex.idx file has been removed from dookug-client-jee10. It caused Unsatisfied Dependency Exception during the deployment.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_migration">7.2.2. Migration</h4>
<div class="paragraph">
<p>Replace <code>TemplateLanguageType.*</code> occurrences with the string value of the language.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_v0_6_0">7.3. v0.6.0</h3>
<div class="sect3">
<h4 id="_changes_updates_2">7.3.1. Changes / updates</h4>
<div class="ulist">
<ul>
<li>
<p>Documentation fixes (formatting, missing 0.5.0 release notes include)</p>
</li>
<li>
<p>Add <a href="https://github.com/jknack/handlebars.java/blob/v4.3.1/handlebars/src/main/java/com/github/jknack/handlebars/helper/StringHelpers.java">com.github.jknack.handlebars.helper.StringHelpers</a> build in helper to helpers</p>
</li>
<li>
<p>Rename formatDate to formatDateTime</p>
</li>
<li>
<p>Create formatDate which handles date format</p>
</li>
<li>
<p>Create formatTime which handles time format</p>
</li>
<li>
<p>Add IT test for owned helpers</p>
</li>
<li>
<p>GET <code>/system/evict</code> REST endpoint added</p>
</li>
<li>
<p>Template caching has been fixed</p>
</li>
<li>
<p>Template caching can be configured with the environment variable named <code>DOOKUG_SERVICE_CACHE_TEMPLATE_ENABLED</code> (<code>true</code> by default)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_migration_2">7.3.2. Migration</h4>
<div class="paragraph">
<p>Changes are backwards compatible doesnt need any migration.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_v1_0_0">7.4. v1.0.0</h3>
<div class="sect3">
<h4 id="_changes_updates_3">7.4.1. Changes / updates</h4>
<div class="ulist">
<ul>
<li>
<p>Jakarta EE10 upgrade</p>
</li>
<li>
<p>Test fix</p>
</li>
<li>
<p>gitHub Workflows - java 17 upgrade</p>
</li>
<li>
<p>Bugfix: The <code>not</code> helper function has been fixed, it evaluated the <code>false</code> parameter incorrectly.</p>
</li>
<li>
<p>Handlebars version bump: 4.3.1 &#8594; 4.4.0</p>
</li>
<li>
<p>Handlebars caching: Handlebars template engine now uses its in-built caching mechanism for compiled templates</p>
</li>
<li>
<p>coff:ee upgrade - migration doc: <a href="https://i-cell-mobilsoft-open-source.github.io/coffee/#_v2_5_0_v2_6_0">2.5.0 &#8594; 2.6.0</a></p>
</li>
<li>
<p>coff:ee upgrade - migration doc: <a href="https://i-cell-mobilsoft-open-source.github.io/coffee/#_v2_6_0_v2_7_0">2.6.0 &#8594; 2.7.0</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The client is not affected by the coffee upgrade, it remains 2.6.0 coffee . The reason for this is that you should upgrade to 2.7.0 on the project that uses coffee.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Because of the coffee upgrade, the use of interfaces had to be removed from the clients, because it already uses the coffee 2.7.0 BaseException, and would cause a break in the client.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>dookug-model</code>, <code>org.hibernate</code> groupId has been replaced by <code>org.hibernate.orm</code>.</p>
</li>
<li>
<p>Roaster upgrade migration: <a href="https://i-cell-mobilsoft-open-source.github.io/roaster/#_2_1_0_2_2_0">2.1.0 &#8594; 2.2.0</a></p>
</li>
<li>
<p>In tests, the coffee.model.base.java.time.timezone.id property in the BaseIT class is set to UTC.</p>
</li>
<li>
<p>New documentation structure</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_migration_3">7.4.2. Migration</h4>
<div class="ulist">
<ul>
<li>
<p>Replace the dookug-client dependency in your project depending on whether you are using JEE 8 or JEE 10.<br></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
	&lt;groupId&gt;hu.icellmobilsoft.dookug.client&lt;/groupId&gt;
	&lt;artifact&gt;dookug-client-jee10&lt;/artifact&gt; <b class="conum">(1)</b>
	&lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
	&lt;groupId&gt;hu.icellmobilsoft.dookug.client&lt;/groupId&gt;
	&lt;artifact&gt;dookug-client-jee8&lt;/artifact&gt; <b class="conum">(2)</b>
	&lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>in case you have EE10 application</p>
</li>
<li>
<p>in case you have EE8 application</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_v1_1_0">7.5. v1.1.0</h3>
<div class="sect3">
<h4 id="_changes_updates_4">7.5.1. Changes / updates</h4>
<div class="ulist">
<ul>
<li>
<p>Documentation has been translated to english.</p>
</li>
<li>
<p>Using the EU DSS Esig library to sign PDF documents (optional)</p>
</li>
<li>
<p>PDF signing: <code>signature</code> key removed from configuration.</p>
</li>
<li>
<p>GitHub workflows for docker build and release build</p>
</li>
<li>
<p>The coffee-module-etcd dependency has been removed.</p>
</li>
<li>
<p>The signatureName and signatureReason has been removed from the request - These are set up in the application configuration under profile name keys</p>
</li>
<li>
<p>Possible extSessionId dupication (in client calls) fixed</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_migration_4">7.5.2. Migration</h4>
<div class="paragraph">
<p>Changes are backwards compatible doesnt need any migration.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-01-15 17:13:37 UTC
</div>
</div>
</body>
</html>